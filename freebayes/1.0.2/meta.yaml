package:
  name: freebayes
  version: "1.0.2"

source:
  fn: freebayes-full-1.0.2.tar.bz2
  url:
    # Use this tarball instead of upstream GitHub one since this one also
    # includes the source code for all the git submodules; this tarball was
    # generated by the "package-freebayes.sh" script provided in the recipe.
    - http://download.lab7.io/sources/freebayes-full-1.0.2.tar.bz2
  md5: 7175cbae1874c5f4501dbecebf771175
  patches:
    - makefiles.patch
    - skip-parallel-test.patch
    - fix-osx-linking.patch     # [osx]
    - ppc64le-support.patch     # [ppc64le]

requirements:
  build:
    - zlib
    - veclib-headers            # [ppc64le]
    # Only needed at build time since we statically link libbamtools
    - bamtools
    # Only needed for "make test"
    - perl
    - samtools
  run:
    - zlib

build:
  number: 0
  script_env:
    - BB_ARCH_FLAGS
    - BB_OPT_FLAGS
    - BB_MAKE_JOBS

test:
  commands:
    - freebayes -h
    - bamleftalign -h

about:
  home: "https://github.com/ekg/freebayes"
  license: MIT
  license_file: LICENSE
  summary: "Bayesian, haplotype-based, genetic variant detector designed to find small polymorphisms"
