{% set version = "1.0.0_rc1_16.05.18" %}

package:
  name: vcflib
  version: "{{ version }}"

source:
  fn: "vcflib_full-{{ version }}.tar.bz2"
  url:
    # Use this tarball instead of upstream GitHub one since this one also
    # includes the source code for all the git submodules; this tarball was
    # generated by the "package-vcflib.sh" script provided in the recipe.
    - "http://download.lab7.io/sources/vcflib_full-{{ version }}.tar.bz2"
  sha1: "8eec36708e8f34555559a3a2fd29080f49956c03"
  patches:
    - makefiles.patch
    - script-paths.patch
    - ppc64le-support.patch     # [ppc64le]

requirements:
  build:
    - biobuilds-build
    - veclib-headers    # [ppc64le]
    - htslib 1.3.*
    - zlib
  run:
    - biobuilds-opt     # [opt]
    - htslib 1.3.*
    - perl
    - python
    - r
    - zlib

build:
  number: 0
  features:
    - opt     # [opt]
  script_env:
    - MAKE_JOBS

test:
  commands:
    - "abba-baba --help &>/dev/null"
    - "bFst --help &>/dev/null"
    - "dumpContigsFromHeader --help &>/dev/null"
    - "genotypeSummary --help &>/dev/null"
    - "pFst --help &>/dev/null"
    - "pVst --help &>/dev/null"
    - "popStats --help &>/dev/null"
    - "smoother --help &>/dev/null"
    - "vcf2dag --help &>/dev/null"
    - "vcf2fasta --help &>/dev/null"
    - "vcfallelicprimitives --help &>/dev/null"
    - "vcfannotate --help &>/dev/null"
    - "vcfbreakmulti --help &>/dev/null"
    - "vcfcheck --help &>/dev/null"
    - "vcfcreatemulti --help &>/dev/null"
    - "vcfentropy --help &>/dev/null"
    - "vcfevenregions --help &>/dev/null"
    - "vcffilter --help &>/dev/null"
    - "vcfgeno2haplo --help &>/dev/null"
    - "vcfglbound --help &>/dev/null"
    - "vcfglxgt --help &>/dev/null"
    - "vcfinfosummarize --help &>/dev/null"
    - "vcfintersect --help &>/dev/null"
    - "vcfleftalign --help &>/dev/null"
    - "vcfoverlay --help &>/dev/null"
    - "vcfprimers --help &>/dev/null"
    - "vcfrandom --help &>/dev/null"
    - "vcfrandomsample --help &>/dev/null"
    - "vcfremap --help &>/dev/null"
    - "vcfroc --help &>/dev/null"
    - "vcfsample2info --help &>/dev/null"
    - "vcfsamplediff --help &>/dev/null"
    - "vcfstats --help &>/dev/null"
    - "vcfstreamsort --help &>/dev/null"
    - "wcFst --help &>/dev/null"

about:
  home: "https://github.com/vcflib/vcflib"
  license: MIT
  license_file: LICENSE
  summary: "C++ library for parsing & manipulating VCF files with many command-line utilities"
