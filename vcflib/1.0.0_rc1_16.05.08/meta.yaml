{% set version = "1.0.0_rc1_16.05.18" %}

package:
  name: vcflib
  version: "{{ version }}"

source:
  fn: "vcflib_full-{{ version }}.tar.bz2"
  url:
    # Use this tarball instead of upstream GitHub one since this one also
    # includes the source code for all the git submodules; this tarball was
    # generated by the "package-vcflib.sh" script provided in the recipe.
    - "http://download.lab7.io/sources/vcflib_full-{{ version }}.tar.bz2"
  sha256: "779b50816da909fad303a15520380821289846531872fea55b7c91a55dcd14e7"
  patches:
    - makefiles.patch
    - script-paths.patch
    - cdflib.patch
    - ppc64le-support.patch     # [ppc64le]

requirements:
  build:
    - biobuilds-build
    - {{ compiler('c') }}       # [toolchain == 'default']
    - {{ compiler('cxx') }}     # [toolchain == 'default']
    - {{ toolchain }}-build     # [toolchain != 'default']
    - veclib-headers            # [ppc64le]
    - htslib {{ htslib }}
    - zlib                      # [toolchain != 'ibm-at10.0']
    - perl {{ perl }}
  run:
    - {{ toolchain }}-runtime   # [toolchain != 'default']
    - htslib
    - zlib                      # [toolchain != 'ibm-at10.0']
    - perl
    - python
    - r-base

build:
  number: 1
  features:
    - opt                       # [toolchain != 'default']

test:
  requires:
    - biobuilds-opt             # [toolchain != 'default']
  commands:
    - "abba-baba --help &>/dev/null"
    - "bFst --help &>/dev/null"
    - "dumpContigsFromHeader --help &>/dev/null"
    - "genotypeSummary --help &>/dev/null"
    - "pFst --help &>/dev/null"
    - "pVst --help &>/dev/null"
    - "popStats --help &>/dev/null"
    - "smoother --help &>/dev/null"
    - "vcf2dag --help &>/dev/null"
    - "vcf2fasta --help &>/dev/null"
    - "vcfallelicprimitives --help &>/dev/null"
    - "vcfannotate --help &>/dev/null"
    - "vcfbreakmulti --help &>/dev/null"
    - "vcfcheck --help &>/dev/null"
    - "vcfcreatemulti --help &>/dev/null"
    - "vcfentropy --help &>/dev/null"
    - "vcfevenregions --help &>/dev/null"
    - "vcffilter --help &>/dev/null"
    - "vcfgeno2haplo --help &>/dev/null"
    - "vcfglbound --help &>/dev/null"
    - "vcfglxgt --help &>/dev/null"
    - "vcfinfosummarize --help &>/dev/null"
    - "vcfintersect --help &>/dev/null"
    - "vcfleftalign --help &>/dev/null"
    - "vcfoverlay --help &>/dev/null"
    - "vcfprimers --help &>/dev/null"
    - "vcfrandom --help &>/dev/null"
    - "vcfrandomsample --help &>/dev/null"
    - "vcfremap --help &>/dev/null"
    - "vcfroc --help &>/dev/null"
    - "vcfsample2info --help &>/dev/null"
    - "vcfsamplediff --help &>/dev/null"
    - "vcfstats --help &>/dev/null"
    - "vcfstreamsort --help &>/dev/null"
    - "wcFst --help &>/dev/null"

about:
  home: "https://github.com/vcflib/vcflib"
  license: MIT
  license_file: LICENSE
  summary: "C++ library for parsing & manipulating VCF files with many command-line utilities"
